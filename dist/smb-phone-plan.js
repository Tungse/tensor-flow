!function(e,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports.smbPhonePlan=n():e.smbPhonePlan=n()}(window,function(){return function(e){var n={};function t(o){if(n[o])return n[o].exports;var r=n[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,t),r.l=!0,r.exports}return t.m=e,t.c=n,t.d=function(e,n,o){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:o})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(t.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)t.d(o,r,function(n){return e[n]}.bind(null,r));return o},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="",t(t.s=0)}([function(e,n,t){e.exports=t(2)},function(e,n,t){},function(e,n,t){"use strict";t.r(n);t(1);var o,r=[],a=function(e,n){var t=l(e),o={category:e,product:n.product,company:n.company,provider:n.provider,productInfoUrl:n.productInfoUrl,title:i(e),link:"".concat(n.link,"&subid=tarifchecker"),price:parseFloat(n.price).toFixed(2)};t>-1?r[t]=o:r.push(o)},i=function(e){var n="Bester Preis im gleichen Netz";return"2:price"===e&&(n="Günstigste Alternative"),"3:condition"===e&&(n="Bessere Konditionen zum selben Preis"),n},l=function(e){for(var n in r)if(r[n].category===e)return n;return-1},c=function(e,n){o=parseFloat(e-n).toFixed(2)},s=function(e){return"o2"===e?"telefónica":e},u=function(e){return e.sort(function(e,n){return e.category<n.category?-1:e.category>n.category?1:0})},p=function(e,n){return e>n+parseFloat("0.1")?"worse":e<n-parseFloat("0.1")?"better":"same"},d=function(e,n){var t=e.lte&&!n.lte,o=n.volume<e.volume,r=e.flatrate&&!n.flatrate;return o||t||r?"worse":JSON.stringify(e)===JSON.stringify(n)?"same":"better"},m={},f={container:"#smb-phone-plan",endpoint:"https://tools.communicationads.net/webservice.php?wf=10506&format=json&calc=handytarif&country=DE&c=200"},v=function(e){m=Object.assign({},m,e)},b=function(e){return e.length>0?0:1},h=function(e){return 0===e.length?90:1===e.length?80:2===e.length?60:40},g={get:function(){return m},set:v,init:function(e){var n=Object.assign({},f,e);v({deals:[],tariffs:[],calculated:!1,emailSended:!1,resultCategory:0,resultPercent:0,priceDiffence:"0",logo:n.logo,endpoint:n.endpoint,container:document.querySelector(n.container)})},setResult:function(e){r=[];var n=function(e,n){for(var t=parseFloat(n.price),o=parseFloat(n.volume),i=t,l=t,m=t,f={lte:n.lte,flatrate:n.flatrate,volume:o},v=0;v<e.length;v++){var b=e[v],h=parseFloat(b.price),g=parseFloat(b.volume),y=s(b.provider),w={lte:b.lte,flatrate:b.flatrate,volume:g},S=d(f,w);y!==n.provider||"same"!==S&&"better"!==S||"better"!==p(h,m)?y===n.provider||"same"!==S&&"better"!==S||"better"!==p(h,l)?"better"===S&&"same"===p(h,t)&&g>=o&&(a("3:condition",b),o=g,i=i>h?h:i):(a("2:price",b),l=h,i=i>h?h:i):(a("1:provider",b),m=h,i=i>h?h:i)}return"better"===p(i,t)&&c(t,i),u(r)}(m.tariffs,e);v({deals:n,calculated:!0,priceDiffence:o,resultCategory:b(n),resultPercent:h(n)})}};function y(e){return(y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var w=function(){try{var e=new XMLHttpRequest;e.open("GET",g.get().endpoint,!0),e.timeout=2500,e.onreadystatechange=function(){4===e.readyState&&200===e.status&&e.response&&g.set({tariffs:S(JSON.parse(e.response))})},e.send()}catch(e){}},S=function(e){var n=[];return e&&"object"===y(e)&&e.forEach(function(e){n.push({link:e.link,product:e.product,company:e.company,lte:"Ja"===e.mobileweb_lte||!1,productInfoUrl:e.url_moreinfo,flatrate:"Flat"===e.services_phone||!1,price:e.cost_pm.replace(",","."),provider:e.provider.toLowerCase(),volume:e.mobileweb_volume.replace("GB","").trim()})}),n},k=function(){return new Promise(function(e,n){g.get().calculated?e():(w(),setTimeout(function(){e()},3e3))})};var L=function(){return"IntersectionObserver"in window&&"IntersectionObserverEntry"in window&&"intersectionRatio"in window.IntersectionObserverEntry.prototype};var T=function(e){let n={top:0,right:0,bottom:0,left:0};return e?("object"==typeof e?(n.top=e.top||0,n.right=e.right||0,n.bottom=e.bottom||0,n.left=e.left||0):n.bottom=e,n):n};var x=function(e,n,t,o,r){if(!t&&!r)return;let a,i,l=!1,c=!1;const s=T(o),u=function(){if(r&&c)try{r()}catch(e){console.error(e)}c=!1},p=function(e){if(t&&!c){try{t()}catch(e){console.error(e)}n&&d(e)}c=!0},d=function(e){L()?a.unobserve(e.target):window.removeEventListener("scroll",f,{capture:!1,passive:!0})},m=function(){var n=(i=e.getBoundingClientRect()).top<=window.innerHeight+s.bottom,t=i.bottom-s.bottom>=0;n&&t?p():u(),l=!1},f=function(){if(l)return!1;window.requestAnimationFrame?(window.requestAnimationFrame(m),l=!0):m()};if(L()){const n={rootMargin:s.top+"px "+s.right+"px "+s.bottom+"px "+s.left+"px"};(a=new IntersectionObserver(function(e){e.forEach(function(e){e.isIntersecting?p(e):u()})},n)).observe(e)}else window.addEventListener("scroll",f,{capture:!1,passive:!0})};var q=function(e,n,t,o){x(e,!0,n,t,o)},C=!1,E=window.location.href,M="Smartphone Rate Calculator",A=function(){if(void 0!==window.smbt)try{window.smbt.emit("custom-event",{hitType:"event",eventCategory:M,eventAction:"Check button clicked",eventLabel:E,metric85:1})}catch(e){}},O=function(e){void 0!==window.smbt&&e.addEventListener("change",function(){D(e),j()})},j=function(){if(!C){try{window.smbt.emit("custom-event",{hitType:"event",eventCategory:M,eventAction:"clicked",eventLabel:E,metric84:1})}catch(e){}C=!0}},D=function e(n){n.removeEventListener("change",function(){e(n),j()})},I=function(){var e=g.get().container.querySelector('[data-role="smb-phone-plan-deals"]');null!==e&&(0===g.get().deals.length?e.innerHTML="":(e.innerHTML='\n      <ul class="list-group smb-phone-plan-deals-list">\n        '.concat(g.get().deals.map(function(e,n){return'\n          <li class="list-group-item smb-phone-plan-deal-item clearfix">\n            <div class="col-sm-8">\n              <h4 class="smb-phone-plan-deal-title">'.concat(e.title,"</h4>\n              ").concat(e.productInfoUrl?"\n                  <p>".concat(e.company?"".concat(e.company,": "):"",'<a href="').concat(e.productInfoUrl,'" target="_blank">').concat(e.product,"</a></p>\n                "):"\n                  <p>".concat(e.company?"".concat(e.company,": "):"").concat(e.product,"</p>\n                "),'\n            </div>\n            <div class="col-sm-4">\n              <div class="text-center smb-phone-plan-deal-price">').concat(e.price,'€</div>\n              <a class="btn btn-primary btn-block" data-role="smb-phone-plan-affiliate-link" href="').concat(e.link,'" target="_blank">Zum Angebot</a>\n            </div>\n          </li>\n        ').trim()}).join(""),"\n      </ul>\n    "),function(){if(void 0!==window.smbt){var e=g.get().container.querySelectorAll('[data-role="smb-phone-plan-affiliate-link"]');0!==e.length&&e.forEach(function(e,n){e.addEventListener("click",function(){try{window.smbt.emit("custom-event",{hitType:"event",eventCategory:M,eventAction:"Offer button ".concat(n+1," clicked"),eventLabel:E,metric86:1})}catch(e){}})})}}()))},P=function(){var e={categoryText:"schlecht",thumbIconClass:"icon-thumbs-down",progressClass:"smb-phone-plan-danger"};return 1===g.get().resultCategory&&(e.categoryText="gut",e.thumbIconClass="icon-thumbs-up",e.progressClass="smb-phone-plan-success"),e},F=function(e){var n=g.get().container.querySelector('[data-role="smb-phone-plan-progress-bar"]');null!==n&&setTimeout(function(){n.style.width="".concat(e,"%")},100)},B=function(){var e=g.get().container.querySelector('[data-role="smb-phone-plan-thumb-icon"]');null!==e&&setTimeout(function(){e.classList.add("shake")},1e3)},G=function(){var e=g.get().container.querySelector('[data-role="smb-phone-plan-send-email"]');null!==e&&e.addEventListener("click",function(){var e=g.get().container.querySelector('[data-role="smb-phone-plan-email"]'),n=g.get().container.querySelector('[data-role="smb-phone-plan-email-input"]');null!==e&&null!==n&&(!1!==function(e){return/\S+@\S+\.\S+/.test(e)}(n.value)?(e.innerHTML="<p>Vielen Dank! Du erhältst von uns eine E-Mail, sobald wir ein Angebot mit den gleichen Konditionen zu einem besseren Preis finden. Bis dahin kannst du entspannt deinen Tarif weiternutzen.</p>",g.set({emailSended:!0}),function(){if(void 0!==window.smbt)try{window.smbt.emit("custom-event",{hitType:"event",eventCategory:M,eventAction:"Mail address added",eventLabel:E})}catch(e){}}()):n.parentElement.classList.add("has-error"))})},z=function(){var e=P(),n=g.get().container.querySelector('[data-role="smb-phone-plan-result"]');n&&(n.innerHTML='\n      <hr />\n      <h3 class="">Dein Ergebnis</h3>\n      <div class="smb-phone-plan-progress">\n        <div class="smb-phone-plan-progress-bar '.concat(e.progressClass,'" data-role="smb-phone-plan-progress-bar"></div>\n        <i class="smb-phone-plan-thumb-icon ').concat(e.thumbIconClass,'" data-role="smb-phone-plan-thumb-icon"></i>\n      </div>\n      ').concat(0===g.get().resultCategory?"\n        <p><strong>Dein Tarif ist ".concat(e.categoryText,". ").concat(g.get().priceDiffence?"Du zahlst ".concat(g.get().priceDiffence.replace(".",","),"€ zu viel im Monat."):"","</strong></p>\n        <p><strong>Hier gibt es bessere Alternativen:</strong></p>\n      "):"\n        <strong>Herzlichen Glückwünsch, du hast einen tollen Tarif!</strong>\n        ".concat(!1===g.get().emailSended?'\n          <hr />\n          <div data-role="smb-phone-plan-email">\n            <p>Informiere mich per E-Mail, wenn es ein besseres Angebot gibt!</p>\n            <div class="row">\n              <div class="form-group col-sm-6">\n                <input type="email" class="form-control" data-role="smb-phone-plan-email-input" placeholder="E-Mail-Adresse">\n              </div>\n              <div class="form-group col-sm-6">\n                <button class="btn btn-primary btn-block" data-role="smb-phone-plan-send-email">Absenden</button>\n              </div>\n            </div>\n          </div>\n        ':"","\n      "),"\n    "),F(g.get().resultPercent),B(),G(),function(e){if(void 0!==window.smbt)try{window.smbt.emit("custom-event",{hitType:"event",eventCategory:M,eventAction:"Current contract ".concat(e),eventLabel:E})}catch(e){}}(e.categoryText))},_=function(){var e,n=g.get().container.querySelector('[data-role="smb-phone-plan-processing"]');n&&(n.innerHTML='\n      <hr />\n      <div class="smb-phone-plan-loading-dot-container text-center">\n        <p>\n          <span class="smb-phone-plan-loading-dot"></span>\n          <span class="smb-phone-plan-loading-dot"></span>\n          <span class="smb-phone-plan-loading-dot"></span>\n        </p>\n      </div>\n      <p class="text-center">'.concat((e=["57 Millionen Deutsche besitzen ein Smartphone. (Quelle: statista)","43% der 20 bis 29-Jährigen in Deutschland nutzen ihr Smartphone mehr als 120 Minuten täglich. (Quelle: statista)","Die Netzabdeckung mit 4G liegt in Deutschland bei 65%, in Norwegen bei 92%. (Quelle: statista)"])[Math.floor(Math.random()*e.length)],"</p>\n    "))};t.d(n,"listenToFormularInteraction",function(){return R});var H=function(){var e=g.get().container.querySelector('[data-role="smb-phone-plan-check"]');null!==e&&e.addEventListener("click",function(){A(),J()})},N=function(){document.onkeydown=function(e){13===e.keyCode&&(A(),J())}},J=function(){var e,n=function(){for(var e=!1,n={},t=g.get().container.querySelectorAll('[data-role="smb-phone-plan-formular-item"]'),o=0;o<t.length;o++){var r=t[o],a=r.dataset.name;r.dataset.required&&""===r.value?(e=!0,r.parentElement.classList.add("has-error")):r.parentElement.classList.remove("has-error"),"checkbox"===r.type?n[a]=r.checked:n[a]=r.value}return e?{}:n}();0!==Object.keys(n).length&&(_(),null===(e=g.get().container.querySelector('[data-role="smb-phone-plan-formular"]'))||e.classList.contains("blur")||e.classList.add("blur"),k().then(function(){g.setResult(n)}).then(function(){var e;(e=g.get().container.querySelector('[data-role="smb-phone-plan-processing"]'))&&e.remove(),z(),I()}))},R=function(){for(var e=g.get().container.querySelectorAll('[data-role="smb-phone-plan-formular-item"]'),n=0;n<e.length;n++){var t=e[n];U(t),O(t)}},U=function(e){e.addEventListener("focus",function(){var e;null!==(e=g.get().container.querySelector('[data-role="smb-phone-plan-formular"]'))&&!1!==e.classList.contains("blur")&&e.classList.remove("blur")})};n.default=function(e){g.init(e),null!==g.get().container&&(g.get().container.innerHTML='\n    <div class="smb-phone-plan-container">\n      <div class="smb-phone-plan-header">\n        <h2 class="smb-phone-plan-title">Wie gut ist dein Handyvertrag?</h2>\n        '.concat(g.get().logo?'\n          <img class="smb-phone-plan-logo" src="'.concat(g.get().logo,'" alt="">\n        '):"",'\n      </div>\n      <div class="smb-phone-plan-body">\n        <div class="smb-phone-plan-formular" data-role="smb-phone-plan-formular">\n          <div class="form-group input-group">\n            <input type="number" class="form-control" placeholder="Wieviel zahlst du pro Monat?" value="" data-role="smb-phone-plan-formular-item" data-name="price" data-required="1">\n            <div class="input-group-addon">€</div>\n          </div>\n          <div class="row">\n            <div class="form-group col-sm-6">\n              <select class="form-control" data-role="smb-phone-plan-formular-item" data-name="provider" data-required="1">\n                <option value="">Netz</option>\n                <option value="d1">Telekom (D1)</option>\n                <option value="d2">Vodafone (D2)</option>\n                <option value="telefónica">Telefónica (O2)</option>\n              </select>\n            </div>\n            <div class="form-group col-sm-6">\n              <select class="form-control" data-role="smb-phone-plan-formular-item" data-name="volume" data-required="1">\n                <option value="">Datenvolumen</option>\n                <option value="0.5">unter 1GB</option>\n                <option value="1">1GB</option>\n                <option value="2">2GB</option>\n                <option value="3">3GB</option>\n                <option value="4">4GB</option>\n                <option value="5">5GB</option>\n                <option value="6">6GB</option>\n                <option value="8">8GB</option>\n                <option value="10">10GB</option>\n              </select>\n            </div>\n          </div>\n          <div class="row form-group clearfix">\n            <div class="col-sm-6">\n              <label class="custom-control-label">\n                <input type="checkbox" class="custom-control-input" data-role="smb-phone-plan-formular-item" data-name="lte">\n                &nbsp;LTE\n              </label>\n            </div>\n            <div class="col-sm-6">\n              <label class="custom-control-label">\n                <input type="checkbox" class="custom-control-input" data-role="smb-phone-plan-formular-item" data-name="flatrate">\n                &nbsp;Telefon-Flatrate\n              </label>\n            </div>\n          </div>\n          <button class="btn btn-primary btn-block" data-role="smb-phone-plan-check">Jetzt prüfen!</button>\n        </div>\n        <div class="smb-phone-plan-processing" data-role="smb-phone-plan-processing"></div>\n        <div class="smb-phone-plan-result" data-role="smb-phone-plan-result"></div>\n        <div class="smb-phone-plan-deals" data-role="smb-phone-plan-deals"></div>\n      </div>\n    </div>\n  '),H(),N(),R(),function(){if(void 0!==window.smbt)try{window.smbt.emit("custom-event",{hitType:"event",eventCategory:M,eventAction:"embed",eventLabel:E,nonInteraction:!0,metric82:1})}catch(e){}}(),void 0!==window.smbt&&q(g.get().container,function(){try{window.smbt.emit("custom-event",{hitType:"event",eventCategory:M,eventAction:"visible",eventLabel:E,nonInteraction:!0,metric83:1})}catch(e){}}))}}]).default});
//# sourceMappingURL=smb-phone-plan.js.map